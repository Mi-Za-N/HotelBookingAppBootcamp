{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/mizan/MobileApp/Grocery/screens/shop/ProductsOverviewScreen.js\";\n\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { Container, Header, Icon, Item, Input, Text } from \"native-base\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport ProductList from \"../../components/shop/ProductItem\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport HeaderButton from \"../../components/UI/HeaderButton\";\nimport { listProducts } from \"../../store/actions/products\";\nimport SearchedProduct from \"./SearchedScreen\";\nimport Colors from \"../../constants/Colors\";\nimport PopUpModal from \"../../components/shop/PopUpModal\";\nimport CartButton from \"../../components/shop/CartButton\";\nimport Category from \"./CategoryScreen\";\nimport { useFocusEffect } from '@react-navigation/native';\nimport baseURL from \"../../assets/common/baseUrl\";\nimport axios from 'axios';\n\nvar ProductsOverviewScreen = function ProductsOverviewScreen(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      products = _useState2[0],\n      setProducts = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      productsFiltered = _useState4[0],\n      setProductsFiltered = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      focus = _useState6[0],\n      setFocus = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      categories = _useState8[0],\n      setCategories = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      productsCtg = _useState10[0],\n      setProductsCtg = _useState10[1];\n\n  var _useState11 = useState(),\n      _useState12 = _slicedToArray(_useState11, 2),\n      active = _useState12[0],\n      setActive = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      initialState = _useState14[0],\n      setInitialState = _useState14[1];\n\n  var _useState15 = useState(true),\n      _useState16 = _slicedToArray(_useState15, 2),\n      loading = _useState16[0],\n      setLoading = _useState16[1];\n\n  useFocusEffect(useCallback(function () {\n    setFocus(false);\n    setActive(-1);\n    axios.get(baseURL + \"products\").then(function (res) {\n      setProducts(res.data);\n      setProductsFiltered(res.data);\n      setProductsCtg(res.data);\n      setInitialState(res.data);\n      setLoading(false);\n    }).catch(function (error) {\n      console.log('Api call error');\n    });\n    axios.get(baseURL + \"categories\").then(function (res) {\n      setCategories(res.data);\n    }).catch(function (error) {\n      console.log('Api call error');\n    });\n  }, []));\n\n  var searchProduct = function searchProduct(text) {\n    setProductsFiltered(products.filter(function (i) {\n      return i.name.toLowerCase().includes(text.toLowerCase());\n    }));\n  };\n\n  var openList = function openList() {\n    setFocus(true);\n  };\n\n  var onBlur = function onBlur() {\n    setFocus(false);\n  };\n\n  var changeCtg = function changeCtg(ctg) {\n    {\n      ctg === \"all\" ? [setProductsCtg(initialState), setActive(true)] : [setProductsCtg(products.filter(function (i) {\n        return i.category._id === ctg;\n      }), setActive(true))];\n    }\n  };\n\n  var cartItems = useSelector(function (state) {\n    var transformedCartItems = [];\n\n    for (var key in state.cart.items) {\n      transformedCartItems.push({\n        productId: key,\n        productTitle: state.cart.items[key].productTitle,\n        productPrice: state.cart.items[key].productPrice,\n        productImage: state.cart.items[key].productImage,\n        quantity: state.cart.items[key].quantity,\n        sum: state.cart.items[key].sum\n      });\n    }\n\n    return transformedCartItems.sort(function (a, b) {\n      return a.productId > b.productId ? 1 : -1;\n    });\n  });\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      isAddMode = _useState18[0],\n      setIsAddMode = _useState18[1];\n\n  var cancelModal = function cancelModal() {\n    setIsAddMode(false);\n  };\n\n  if (loading) {\n    return React.createElement(View, {\n      style: styles.centered,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 7\n      }\n    }, React.createElement(ActivityIndicator, {\n      size: \"large\",\n      color: Colors.primary,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  if (!loading && products.length === 0) {\n    return React.createElement(View, {\n      style: styles.centered,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 7\n      }\n    }, React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }\n    }, \"No products found. Maybe start adding some!\"));\n  }\n\n  var selectItemHandler = function selectItemHandler(item) {\n    props.navigation.navigate(\"ProductDetail\", {\n      item: item\n    });\n  };\n\n  return React.createElement(View, {\n    style: styles.main,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 6\n    }\n  }, loading == false ? React.createElement(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 2\n    }\n  }, React.createElement(Header, {\n    searchBar: true,\n    rounded: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 2\n    }\n  }, React.createElement(Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 4\n    }\n  }, React.createElement(Icon, {\n    name: \"ios-search\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 6\n    }\n  }), React.createElement(Input, {\n    placeholder: \"Search\",\n    onFocus: openList,\n    onChangeText: function onChangeText(text) {\n      return searchProduct(text);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 6\n    }\n  }), focus == true ? React.createElement(Icon, {\n    onPress: onBlur,\n    name: \"ios-close\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 23\n    }\n  }) : null)), focus == true ? React.createElement(SearchedProduct, {\n    navigation: props.navigation,\n    productsFiltered: productsFiltered,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 4\n    }\n  }) : React.createElement(ScrollView, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 4\n    }\n  }, React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 6\n    }\n  }, React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 8\n    }\n  }, React.createElement(Category, {\n    categories: categories,\n    categoryFilter: changeCtg,\n    productsCtg: productsCtg,\n    active: active,\n    setActive: setActive,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 10\n    }\n  })), productsCtg.length > 0 ? React.createElement(View, {\n    style: styles.listContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 8\n    }\n  }, productsCtg.map(function (item) {\n    return React.createElement(ProductList, {\n      key: item._id,\n      id: item._id,\n      product: item,\n      image: item.image,\n      title: item.name,\n      price: item.price,\n      onSelect: function onSelect() {\n        selectItemHandler(item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 18\n      }\n    });\n  })) : React.createElement(View, {\n    style: [styles.center, {\n      height: height / 2\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 12\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 16\n    }\n  }, \"No products found\"))))) : React.createElement(Container, {\n    style: [styles.center, {\n      backgroundColor: \"#f2f2f2\"\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 7\n    }\n  }, React.createElement(ActivityIndicator, {\n    size: \"large\",\n    color: \"red\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 9\n    }\n  })), cartItems.length !== 0 && React.createElement(View, {\n    style: styles.screen,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, React.createElement(CartButton, {\n    onPress: function onPress() {\n      return setIsAddMode(true);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 9\n    }\n  }), React.createElement(PopUpModal, {\n    visible: isAddMode,\n    onCancel: cancelModal,\n    onSelect: function onSelect() {\n      props.navigation.navigate(\"Shipping\");\n      cancelModal();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport var screenOptions = function screenOptions(navData) {\n  return {\n    headerTitle: \"Grocery Shop\",\n    headerLeft: function headerLeft() {\n      return React.createElement(Ionicons, {\n        title: \"Menu\",\n        name: Platform.OS === \"android\" ? \"md-menu\" : \"ios-menu\",\n        size: 29,\n        color: Colors.white,\n        onPress: function onPress() {\n          navData.navigation.toggleDrawer();\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 9\n        }\n      });\n    }\n  };\n};\nvar styles = StyleSheet.create({\n  main: {\n    flex: 1\n  },\n  centered: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  cartItems: {\n    position: \"absolute\",\n    zIndex: 999,\n    fontSize: 18,\n    fontWeight: \"bold\",\n    color: \"#ffffff\"\n  }\n});\nexport default ProductsOverviewScreen;","map":{"version":3,"sources":["/home/mizan/MobileApp/Grocery/screens/shop/ProductsOverviewScreen.js"],"names":["React","useEffect","useState","useCallback","Container","Header","Icon","Item","Input","Text","useSelector","useDispatch","ProductList","Ionicons","HeaderButton","listProducts","SearchedProduct","Colors","PopUpModal","CartButton","Category","useFocusEffect","baseURL","axios","ProductsOverviewScreen","props","products","setProducts","productsFiltered","setProductsFiltered","focus","setFocus","categories","setCategories","productsCtg","setProductsCtg","active","setActive","initialState","setInitialState","loading","setLoading","get","then","res","data","catch","error","console","log","searchProduct","text","filter","i","name","toLowerCase","includes","openList","onBlur","changeCtg","ctg","category","_id","cartItems","state","transformedCartItems","key","cart","items","push","productId","productTitle","productPrice","productImage","quantity","sum","sort","a","b","isAddMode","setIsAddMode","cancelModal","styles","centered","primary","length","selectItemHandler","item","navigation","navigate","main","listContainer","map","image","price","center","height","backgroundColor","screen","screenOptions","navData","headerTitle","headerLeft","Platform","OS","white","toggleDrawer","StyleSheet","create","flex","justifyContent","alignItems","position","zIndex","fontSize","fontWeight","color"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useCallback  } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  ActivityIndicator,\n  ScrollView\n} from \"react-native\";\nimport { Container, Header, Icon, Item, Input, Text } from \"native-base\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport ProductList from \"../../components/shop/ProductItem\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport HeaderButton from \"../../components/UI/HeaderButton\";\nimport { listProducts } from \"../../store/actions/products\";\nimport SearchedProduct from \"./SearchedScreen\";\nimport Colors from \"../../constants/Colors\";\nimport PopUpModal from \"../../components/shop/PopUpModal\"\nimport CartButton from \"../../components/shop/CartButton\";\nimport Category from \"./CategoryScreen\"\n\nimport { useFocusEffect } from '@react-navigation/native'\nimport baseURL from \"../../assets/common/baseUrl\";\nimport axios from 'axios';\n\nconst ProductsOverviewScreen = (props) => {\n    const [products, setProducts] = useState([]);\n  const [productsFiltered, setProductsFiltered] = useState([]);\n  const [focus, setFocus] = useState();\n  const [categories, setCategories] = useState([]);\n  const [productsCtg, setProductsCtg] = useState([]);\n  const [active, setActive] = useState();\n  const [initialState, setInitialState] = useState([]);\n  const [loading, setLoading] = useState(true)\n\n  useFocusEffect((\n    useCallback(\n      () => {\n        setFocus(false);\n        setActive(-1);\n        \n        // Products\n        axios\n          .get(`${baseURL}products`)\n          .then((res) => {\n            setProducts(res.data);\n            setProductsFiltered(res.data);\n            setProductsCtg(res.data);\n            setInitialState(res.data);\n            setLoading(false)\n          })\n          .catch((error) => {\n            console.log('Api call error')\n          })\n    \n        // Categories\n        axios\n          .get(`${baseURL}categories`)\n          .then((res) => {\n            setCategories(res.data)\n          })\n          .catch((error) => {\n            console.log('Api call error')\n          })\n    \n        // return () => {\n        //   setProducts([]);\n        //   setProductsFiltered([]);\n        //   setFocus();\n        //   setCategories([]);\n        //   setActive();\n        //   setInitialState();\n        // };\n      },\n      [],\n    )\n  ))\n    \n\n      // Product Methods\n  const searchProduct = (text) => {\n    setProductsFiltered(\n      products.filter((i) => i.name.toLowerCase().includes(text.toLowerCase()))\n    );\n  };\n\n  const openList = () => {\n    setFocus(true);\n  };\n\n  const onBlur = () => {\n    setFocus(false);\n  };\n\n    const changeCtg = (ctg) => {\n    {\n      ctg === \"all\"\n        ? [setProductsCtg(initialState), setActive(true)]\n        : [\n            setProductsCtg(\n              products.filter((i) => i.category._id === ctg),\n              setActive(true)\n            ),\n          ];\n    }\n  };\n\n\n\n\n  const cartItems = useSelector((state) => {\n    const transformedCartItems = [];\n    for (const key in state.cart.items) {\n      transformedCartItems.push({\n        productId: key,\n        productTitle: state.cart.items[key].productTitle,\n        productPrice: state.cart.items[key].productPrice,\n        productImage: state.cart.items[key].productImage,\n        quantity: state.cart.items[key].quantity,\n        sum: state.cart.items[key].sum,\n      });\n    }\n    return transformedCartItems.sort((a, b) =>\n      a.productId > b.productId ? 1 : -1\n    );\n  });\n  const [isAddMode, setIsAddMode] = useState(false);\n  const cancelModal = () => {\n    setIsAddMode(false);\n  };\n\n  // const productList = useSelector((state) => state.productList);\n  // const { products, loading, error } = productList;\n  // const dispatch = useDispatch();\n  // useEffect(() => {\n  //   dispatch(listProducts());\n  // }, []);\n\n  //   if (error) {\n  //   return (\n  //     <View style={styles.centered}>\n  //       <Text>An error occurred!</Text>\n  //       <Button\n  //         title=\"Try again\"\n  //         // onPress={loadProducts}\n  //         color={Colors.primary}\n  //       />\n  //     </View>\n  //   );\n  // }\n\n  if (loading) {\n    return (\n      <View style={styles.centered}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </View>\n    );\n  }\n\n  if (!loading && products.length === 0) {\n    return (\n      <View style={styles.centered}>\n        <Text>No products found. Maybe start adding some!</Text>\n      </View>\n    );\n  }\n\n   const selectItemHandler = (item) => {\n    props.navigation.navigate(\"ProductDetail\", {\n      item: item\n    });\n  };\n\n  return (\n     <View style={styles.main}>\n    {loading == false ? (\n <Container>\n <Header searchBar rounded>\n   <Item>\n     <Icon name=\"ios-search\" />\n     <Input\n       placeholder=\"Search\"\n       onFocus={openList}\n       onChangeText={(text) => searchProduct(text)}\n     />\n     {focus == true ? <Icon onPress={onBlur} name=\"ios-close\" /> : null}\n   </Item>\n </Header>\n {focus == true ? (\n   <SearchedProduct \n   navigation={props.navigation}\n   productsFiltered={productsFiltered} />\n ) : (\n   <ScrollView>\n     <View>\n       {/* <View>\n         <Banner />\n       </View> */}\n       <View>\n         <Category\n           categories={categories}\n           categoryFilter={changeCtg}\n           productsCtg={productsCtg}\n           active={active}\n           setActive={setActive}\n         />\n       </View>\n       {productsCtg.length > 0 ? (\n       <View style={styles.listContainer}>\n           {productsCtg.map((item) => {\n               return(\n                 <ProductList\n                    key={item._id}\n                    id={item._id}\n                    product={item}\n                    image={item.image}\n                    title={item.name}\n                    price={item.price}\n                    onSelect={() => {\n                      selectItemHandler(item);\n                    }}\n                  />\n               )\n           })}\n       </View>\n       ) : (\n           <View style={[styles.center, { height: height / 2}]}>\n               <Text>No products found</Text>\n           </View>\n       )}\n      \n     </View>\n   </ScrollView>\n )}\n</Container>\n    ) : (\n      // Loading\n      <Container style={[styles.center, { backgroundColor: \"#f2f2f2\" }]}>\n        <ActivityIndicator size=\"large\" color=\"red\" />\n      </Container>\n)}\n        {cartItems.length !== 0 && \n        <View style={styles.screen}>\n        <CartButton onPress={() => setIsAddMode(true)} />\n        <PopUpModal\n          visible={isAddMode}\n          onCancel={cancelModal}\n          onSelect={() => { props.navigation.navigate(\"Shipping\");\n              cancelModal()}}/>\n        </View>\n        }\n    </View>\n  );\n};\n\nexport const screenOptions = (navData) => {\n  return {\n    headerTitle: \"Grocery Shop\",\n    headerLeft: () => (\n        <Ionicons\n          title=\"Menu\"\n          name={Platform.OS === \"android\" ? \"md-menu\": \"ios-menu\"}\n          size={29}\n          color={Colors.white}\n          onPress={() => {\n            navData.navigation.toggleDrawer();\n          }}\n        />\n    ),\n  };\n};\n\nconst styles = StyleSheet.create({\n  main: {\n    flex: 1,\n  },\n  centered: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  cartItems: {\n    position: \"absolute\",\n    zIndex: 999,\n    fontSize: 18,\n    fontWeight: \"bold\",\n    color: \"#ffffff\",\n  },\n});\n\nexport default ProductsOverviewScreen;\n"]},"metadata":{},"sourceType":"module"}